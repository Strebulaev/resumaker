<div class="ai-config-modal">
  <div class="providers-grid">
    <div *ngFor="let provider of providers" 
         class="provider-card"
         [class.configured]="provider.isConfigured"
         [class.current]="isCurrentProvider(provider.id)"
         [class.default-provider]="provider.isDefault">
      
      <div class="provider-header">
        <h3>{{ provider.name }}</h3>
        <div class="provider-status">
          <span *ngIf="provider.isDefault" class="status-badge default">
            {{ 'AI_CONFIG.STATUS.DEFAULT' | translate }}
          </span>
          <span *ngIf="provider.isConfigured" class="status-badge configured">
            {{ 'AI_CONFIG.STATUS.CONFIGURED' | translate }}
          </span>
          <span *ngIf="isCurrentProvider(provider.id)" class="status-badge active-text">
            {{ 'AI_CONFIG.STATUS.ACTIVE' | translate }}
          </span>
        </div>
      </div>

      <div class="provider-config" *ngIf="editingProvider === provider.id">
        <div class="config-field">
          <label>{{ 'AI_CONFIG.FIELDS.API_KEY' | translate }}:</label>
          <input type="password" 
                 [(ngModel)]="provider.apiKey"
                 [placeholder]="provider.isDefault ? 
                   ('AI_CONFIG.FIELDS.API_KEY_PLACEHOLDER_DEFAULT' | translate) : 
                   ('AI_CONFIG.FIELDS.API_KEY_PLACEHOLDER' | translate)"
                 [disabled]="!!(provider.isDefault && provider.isConfigured)">
        </div>
        
        <div class="config-field">
          <label>{{ 'AI_CONFIG.FIELDS.BASE_URL' | translate }}:</label>
          <input type="text" 
                 [(ngModel)]="provider.baseUrl"
                 [placeholder]="provider.baseUrl"
                 [disabled]="!!provider.isDefault">
        </div>

        <div class="config-actions">
          <button pButton 
                  [label]="'AI_CONFIG.BUTTONS.SAVE' | translate" 
                  (click)="saveProviderConfig(provider)"
                  class="p-button-success"
                  [disabled]="!!provider.isDefault">
          </button>
          <button pButton 
                  [label]="'AI_CONFIG.BUTTONS.CANCEL' | translate" 
                  (click)="cancelEdit()"
                  class="p-button-secondary">
          </button>
          <button *ngIf="provider.isConfigured"
                  pButton 
                  [label]="'AI_CONFIG.BUTTONS.TEST_CONNECTION' | translate" 
                  (click)="testConnection(provider.id)"
                  class="p-button-info">
          </button>
        </div>
      </div>

      <div class="provider-actions" *ngIf="editingProvider !== provider.id">
        <button pButton 
                [label]="provider.isConfigured ? 
                  ('AI_CONFIG.BUTTONS.EDIT' | translate) : 
                  ('AI_CONFIG.BUTTONS.CONFIGURE' | translate)"
                (click)="editProvider(provider.id)"
                class="p-button-outlined"
                [disabled]="!!(provider.isDefault && provider.isConfigured)">
        </button>
        
        <button *ngIf="provider.isConfigured && !isCurrentProvider(provider.id)"
                pButton 
                [label]="'AI_CONFIG.BUTTONS.USE' | translate" 
                (click)="setCurrentProvider(provider.id)"
                class="p-button-success">
        </button>

        <button *ngIf="provider.isDefault && !provider.isConfigured"
                pButton 
                [label]="'AI_CONFIG.BUTTONS.CONNECT' | translate" 
                (click)="connectTogetherAI()"
                class="p-button-help">
          <i class="pi pi-plug"></i>
        </button>
      </div>
    </div>
  </div>

  <div class="connection-help">
    <h4>{{ 'AI_CONFIG.HELP.TITLE' | translate }}</h4>
    <ul>
      <li>{{ 'AI_CONFIG.HELP.CHECK_API_KEY' | translate }}</li>
      <li>{{ 'AI_CONFIG.HELP.CHECK_PERMISSIONS' | translate }}</li>
      <li>{{ 'AI_CONFIG.HELP.TOGETHER_AI_AUTO' | translate }}</li>
      <li>{{ 'AI_CONFIG.HELP.CORS_ERRORS' | translate }}</li>
    </ul>
  </div>
</div>