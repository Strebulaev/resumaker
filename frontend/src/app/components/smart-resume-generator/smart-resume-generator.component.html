<div class="smart-resume-generator">
  <div class="header">
    <h2>–£–º–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ä–µ–∑—é–º–µ</h2>
    <p>–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–µ–∑—é–º–µ –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π</p>
  </div>

  <div class="generator-form">
    <div class="form-section">
      <h3>–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ—Ñ–∏–ª–∏</h3>
      <div class="profiles-grid">
        <div
          class="profile-card"
          *ngFor="let profile of profiles"
          [class.selected]="isProfileSelected(profile.id)"
          (click)="toggleProfileSelection(profile.id)">
          <div class="profile-header">
            <h4>{{ profile.name }}</h4>
            <input type="checkbox" [checked]="isProfileSelected(profile.id)" readonly>
          </div>
          <p>{{ profile.name }}</p>
          <div class="profile-stats">
            <span>–û–ø—ã—Ç: {{ profile.data?.experience?.length || 0 }}</span>
            <span>–ü—Ä–æ–µ–∫—Ç—ã: {{ profile.data?.projects?.length || 0 }}</span>
            <span>–ù–∞–≤—ã–∫–∏: {{ profile.data?.skills?.length || 0 }}</span>
          </div>
        </div>
      </div>
    </div>

    <div class="form-section">
      <h3>–¶–µ–ª–µ–≤–∞—è –ø–æ–∑–∏—Ü–∏—è</h3>
      <div class="form-group">
        <label>–î–æ–ª–∂–Ω–æ—Å—Ç—å</label>
        <input type="text" [(ngModel)]="targetPosition" placeholder="Senior Frontend Developer">
      </div>
      <div class="form-group">
        <label>–ö–æ–º–ø–∞–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
        <input type="text" [(ngModel)]="companyName" placeholder="Google">
      </div>
      <div class="form-group">
        <label>–û–ø–∏—Å–∞–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
        <textarea [(ngModel)]="vacancyDescription" rows="4" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–∏ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–µ–∑—é–º–µ"></textarea>
      </div>
    </div>

    <div class="form-section">
      <div class="section-header" (click)="showAdvanced = !showAdvanced">
        <h3>–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
        <span class="toggle-icon">{{ showAdvanced ? '‚ñº' : '‚ñ∂' }}</span>
      </div>

      <div class="advanced-settings" [class.expanded]="showAdvanced">
        <div class="form-group">
          <label>–ê–∫—Ü–µ–Ω—Ç—ã</label>
          <div class="checkbox-grid">
            <label *ngFor="let option of emphasisOptions" class="checkbox-item">
              <input
                type="checkbox"
                [checked]="isEmphasisSelected(option.value)"
                (change)="toggleEmphasis(option.value)">
              {{ option.label }}
            </label>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>–î–ª–∏–Ω–∞ —Ä–µ–∑—é–º–µ</label>
            <select [(ngModel)]="selectedLength">
              <option *ngFor="let option of lengthOptions" [value]="option.value">
                {{ option.label }}
              </option>
            </select>
          </div>

          <div class="form-group">
            <label>–¢–æ–Ω</label>
            <select [(ngModel)]="selectedTone">
              <option *ngFor="let option of toneOptions" [value]="option.value">
                {{ option.label }}
              </option>
            </select>
          </div>
        </div>
      </div>
    </div>

    <div class="form-actions">
      <button class="btn-generate" (click)="generateResume()" [disabled]="isGenerating || selectedProfiles.length === 0 || !targetPosition.trim()">
        <span *ngIf="isGenerating">–ì–µ–Ω–µ—Ä–∞—Ü–∏—è...</span>
        <span *ngIf="!isGenerating">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—é–º–µ</span>
      </button>
      <button class="btn-reset" (click)="resetForm()">–°–±—Ä–æ—Å–∏—Ç—å</button>
    </div>
  </div>

  <div class="generated-resume" *ngIf="generatedResume">
    <div class="resume-header">
      <h3>{{ generatedResume.title }}</h3>
      <div class="resume-actions">
        <button class="btn-optimize" (click)="optimizeForVacancy()" *ngIf="vacancyDescription">
          –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ –≤–∞–∫–∞–Ω—Å–∏—é
        </button>
        <div class="export-dropdown">
          <button class="btn-export">–≠–∫—Å–ø–æ—Ä—Ç ‚ñº</button>
          <div class="export-options">
            <button *ngFor="let format of exportFormats" (click)="exportResume(format.value)">
              {{ format.label }}
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="resume-content">
      <div class="resume-section" *ngIf="generatedResume.content.summary">
        <h4>üìù –†–µ–∑—é–º–µ</h4>
        <p>{{ generatedResume.content.summary }}</p>
      </div>

      <div class="resume-section" *ngIf="generatedResume.content.experience.length > 0">
        <h4>üíº –û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã</h4>
        <div class="experience-item" *ngFor="let exp of generatedResume.content.experience">
          <div class="exp-header">
            <h5>{{ exp.position }} - {{ exp.company }}</h5>
            <span class="exp-dates">{{ exp.startDate }} - {{ exp.endDate || '–Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è' }}</span>
          </div>
          <p>{{ exp.description }}</p>
          <ul *ngIf="exp.achievements.length > 0">
            <li *ngFor="let achievement of exp.achievements">{{ achievement }}</li>
          </ul>
          <div class="exp-meta">
            <span class="source-profile">–ò–∑ –ø—Ä–æ—Ñ–∏–ª—è: {{ getProfileContribution(exp.sourceProfile)?.profileName }}</span>
          </div>
        </div>
      </div>

      <div class="resume-section" *ngIf="generatedResume.content.projects.length > 0">
        <h4>üöÄ –ü—Ä–æ–µ–∫—Ç—ã</h4>
        <div class="project-item" *ngFor="let project of generatedResume.content.projects">
          <div class="project-header">
            <h5>{{ project.name }}</h5>
            <span class="project-role">{{ project.role }}</span>
          </div>
          <p>{{ project.description }}</p>
          <div class="project-tech">
            <strong>–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:</strong> {{ project.technologies.join(', ') }}
          </div>
          <ul *ngIf="project.achievements.length > 0">
            <li *ngFor="let achievement of project.achievements">{{ achievement }}</li>
          </ul>
          <div class="project-meta">
            <span class="source-profile">–ò–∑ –ø—Ä–æ—Ñ–∏–ª—è: {{ getProfileContribution(project.sourceProfile)?.profileName }}</span>
          </div>
        </div>
      </div>

      <div class="resume-section" *ngIf="generatedResume.content.skills.length > 0">
        <h4>üõ†Ô∏è –ù–∞–≤—ã–∫–∏</h4>
        <div class="skills-grid">
          <div class="skill-item" *ngFor="let skill of generatedResume.content.skills">
            <span class="skill-name">{{ skill.name }}</span>
            <span class="skill-level">{{ skill.level }}</span>
            <span class="skill-exp">{{ skill.yearsOfExperience }} –ª–µ—Ç</span>
          </div>
        </div>
      </div>
    </div>

    <div class="profile-contributions">
      <h4>–í–∫–ª–∞–¥ –ø—Ä–æ—Ñ–∏–ª–µ–π</h4>
      <div class="contributions-list">
        <div class="contribution-item" *ngFor="let contribution of generatedResume.profiles">
          <div class="contribution-header">
            <span class="profile-name">{{ contribution.profileName }}</span>
            <span class="contribution-weight">{{ contribution.weight }}%</span>
          </div>
          <div class="contribution-sections">
            <span *ngFor="let section of contribution.sections" class="section-tag">
              {{ getSectionIcon(section.sectionType) }} {{ section.sectionType }}
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>