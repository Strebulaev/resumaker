<div class="analytics-dashboard">
  <div class="header">
    <h2>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã</h2>
    <div class="period-selector">
      <button
        class="period-btn"
        [class.active]="selectedPeriod === 'week'"
        (click)="changePeriod('week')">–ù–µ–¥–µ–ª—è</button>
      <button
        class="period-btn"
        [class.active]="selectedPeriod === 'month'"
        (click)="changePeriod('month')">–ú–µ—Å—è—Ü</button>
      <button
        class="period-btn"
        [class.active]="selectedPeriod === 'quarter'"
        (click)="changePeriod('quarter')">–ö–≤–∞—Ä—Ç–∞–ª</button>
    </div>
  </div>

  <div class="overview-cards" *ngIf="dashboardData$ | async as dashboard">
    <div class="metric-card">
      <div class="metric-value">{{ dashboard.overview.totalViews }}</div>
      <div class="metric-label">–ü—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –ø—Ä–æ—Ñ–∏–ª—è</div>
      <div class="metric-change positive">+12%</div>
    </div>
    <div class="metric-card">
      <div class="metric-value">{{ dashboard.overview.totalApplications }}</div>
      <div class="metric-label">–ó–∞—è–≤–æ–∫ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ</div>
      <div class="metric-change positive">+8%</div>
    </div>
    <div class="metric-card">
      <div class="metric-value">{{ (dashboard.overview.responseRate * 100).toFixed(1) }}%</div>
      <div class="metric-label">–£—Ä–æ–≤–µ–Ω—å –æ—Ç–∫–ª–∏–∫–∞</div>
      <div class="metric-change positive">+5%</div>
    </div>
    <div class="metric-card">
      <div class="metric-value">{{ dashboard.overview.averageResponseTime.toFixed(1) }}</div>
      <div class="metric-label">–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ (–¥–Ω–∏)</div>
      <div class="metric-change negative">+2</div>
    </div>
  </div>

  <div class="charts-section" *ngIf="dashboardData$ | async as dashboard">
    <div class="chart-container" *ngFor="let chart of dashboard.charts">
      <h3>{{ chart.title }}</h3>
      <div class="chart-placeholder">
        <div class="chart-icon">üìä</div>
        <p>–ì—Ä–∞—Ñ–∏–∫ –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å</p>
      </div>
    </div>
  </div>

  <div class="insights-section" *ngIf="dashboardData$ | async as dashboard">
    <h3>–ò–Ω—Å–∞–π—Ç—ã</h3>
    <div class="insights-list">
      <div class="insight-card" *ngFor="let insight of dashboard.insights">
        <div class="insight-header">
          <span class="insight-icon">{{ getInsightTypeIcon(insight.type) }}</span>
          <span class="insight-type" [class]="'impact-' + insight.impact.toLowerCase()">{{ insight.impact }}</span>
        </div>
        <h4>{{ insight.title }}</h4>
        <p>{{ insight.description }}</p>
      </div>
    </div>
  </div>

  <div class="recommendations-section" *ngIf="dashboardData$ | async as dashboard">
    <h3>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h3>
    <div class="recommendations-list">
      <div class="recommendation-card" *ngFor="let rec of dashboard.recommendations">
        <div class="rec-header">
          <h4>{{ rec.title }}</h4>
          <span class="rec-priority" [class]="getPriorityClass(rec.priority.toLowerCase())">{{ rec.priority }}</span>
        </div>
        <p>{{ rec.description }}</p>
        <div class="rec-actions">
          <h5>–î–µ–π—Å—Ç–≤–∏—è:</h5>
          <ul>
            <li *ngFor="let action of rec.actions">
              <input type="checkbox" [checked]="action.completed" disabled>
              {{ action.description }}
            </li>
          </ul>
        </div>
        <div class="rec-impact">
          <strong>–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:</strong> {{ rec.expectedImpact }}
        </div>
      </div>
    </div>
  </div>

  <div class="alerts-section">
    <h3>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h3>
    <div class="alerts-list">
      <div class="alert-card" *ngFor="let alert of alerts" [class.unread]="!alert.read">
        <div class="alert-header">
          <span class="alert-severity" [class]="getAlertSeverityClass(alert.severity.toLowerCase())">{{ alert.severity }}</span>
          <small>{{ alert.createdAt | date:'short' }}</small>
        </div>
        <h4>{{ alert.title }}</h4>
        <p>{{ alert.message }}</p>
        <button class="mark-read-btn" (click)="markAlertAsRead(alert)" *ngIf="!alert.read">
          –û—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ
        </button>
      </div>
    </div>
  </div>

  <div class="reports-section">
    <div class="reports-header">
      <h3>–û—Ç—á–µ—Ç—ã</h3>
      <div class="report-actions">
        <button class="generate-btn" (click)="generateReport('application_summary')">–°–æ–∑–¥–∞—Ç—å –æ—Ç—á–µ—Ç –ø–æ –∑–∞—è–≤–∫–∞–º</button>
        <button class="generate-btn" (click)="generateReport('skill_analysis')">–ê–Ω–∞–ª–∏–∑ –Ω–∞–≤—ã–∫–æ–≤</button>
        <button class="generate-btn" (click)="generateReport('performance_report')">–û—Ç—á–µ—Ç –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</button>
      </div>
    </div>
    <div class="reports-list">
      <div class="report-card" *ngFor="let report of reports">
        <div class="report-info">
          <h4>{{ report.title }}</h4>
          <p>–ü–µ—Ä–∏–æ–¥: {{ report.dateRange.start | date:'short' }} - {{ report.dateRange.end | date:'short' }}</p>
          <small>–°–æ–∑–¥–∞–Ω: {{ report.generatedAt | date:'short' }}</small>
        </div>
        <div class="report-actions">
          <button class="download-btn">–°–∫–∞—á–∞—Ç—å {{ report.format.toUpperCase() }}</button>
        </div>
      </div>
    </div>
  </div>
</div>